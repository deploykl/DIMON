<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power BI Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .spinner {
            border: 3px solid #e5e7eb;
            border-top: 3px solid #1e3c72;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        /* Arreglo para pantalla completa */
        #dashboardContainer:-webkit-full-screen {
            width: 100vw !important;
            height: 100vh !important;
            border-radius: 0 !important;
        }
        
        #dashboardContainer:-moz-full-screen {
            width: 100vw !important;
            height: 100vh !important;
            border-radius: 0 !important;
        }
        
        #dashboardContainer:-ms-fullscreen {
            width: 100vw !important;
            height: 100vh !important;
            border-radius: 0 !important;
        }
        
        #dashboardContainer:fullscreen {
            width: 100vw !important;
            height: 100vh !important;
            border-radius: 0 !important;
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e3c72',
                        'primary-light': '#2a5298',
                        accent: '#00b4d8',
                    },
                    animation: {
                        'pulse-slow': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <header class="mb-10">
            <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-8">
                <div class="flex items-center gap-3">
                    <div class="gradient-bg w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold shadow-md">
                        PB
                    </div>
                    <span class="text-xl font-semibold text-primary">Power BI Analytics</span>
                </div>
                <div>
                    <button id="toggleStats" class="px-5 py-2.5 bg-white border border-gray-200 rounded-xl flex items-center gap-2 text-gray-700 hover:bg-gray-50 transition-all duration-300 shadow-sm hover:shadow-md">
                        <i class="fas fa-chart-bar"></i>
                        <span>Mostrar Info</span>
                    </button>
                </div>
            </div>
           
        </header>
        
        <!-- Dashboard Container -->
        <main class="mb-12">
            <div id="dashboardContainer" class="bg-white rounded-2xl shadow-2xl overflow-hidden transition-all duration-300">
                <!-- Dashboard Header -->
                <div class="px-6 py-5 md:px-8 md:py-6 border-b border-gray-100 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-5 bg-white">
                    <div class="flex items-center gap-4">
                        <div class="bg-gray-50 w-12 h-12 rounded-xl flex items-center justify-center text-primary shadow-inner">
                            <i class="fas fa-tachometer-alt text-lg"></i>
                        </div>
                        <h2 class="text-xl md:text-2xl font-bold text-primary">
                            Análisis de Datos - Informe Interactivo
                        </h2>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row gap-3 w-full lg:w-auto">
                        
                        <button id="fullscreenBtn" class="px-5 py-3 gradient-bg text-white rounded-xl flex items-center justify-center gap-2 hover:opacity-90 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                            <i class="fas fa-expand"></i>
                            <span class="font-medium">Pantalla Completa</span>
                        </button>
                    </div>
                </div>
                
                <!-- Power BI Iframe -->
                <div class="relative bg-gray-50">
                    <!-- Loading State -->
                    <div id="loading" class="absolute inset-0 bg-white/95 backdrop-blur-sm flex flex-col items-center justify-center z-10 transition-opacity duration-300">
                        <div class="spinner w-14 h-14 mb-5"></div>
                        <p class="text-gray-700 text-lg font-medium">Cargando dashboard de Power BI...</p>
                        <p class="text-gray-500 text-sm mt-2">Por favor espere un momento</p>
                    </div>
                    
                    <!-- Power BI Iframe -->
                    <iframe 
                        id="powerbiFrame"
                        class="w-full h-[75vh] min-h-[600px] border-0"
                        src="https://app.powerbi.com/view?r=eyJrIjoiODhjODhjN2ItMTFlYy00M2VjLWE2ZDAtNjAzODc1MzMwMmE1IiwidCI6Ijc5MDVjMWZjLTkzM2MtNDUyYS04YjgzLWIyZTU2NDU1ZDE2YSIsImMiOjR9"
                        title="Power BI Dashboard"
                        allowfullscreen
                        loading="eager">
                    </iframe>
                </div>
                
                <!-- Info Cards -->
                <div id="statsSection" class="px-6 py-10 md:px-8 md:py-12 bg-white border-t border-gray-100 grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Card 1 -->
                    <div class="bg-gradient-to-br from-gray-50 to-white p-7 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 border border-gray-100">
                        <div class="gradient-bg w-14 h-14 rounded-xl flex items-center justify-center text-white mb-5 shadow-md">
                            <i class="fas fa-mouse-pointer text-xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-primary mb-3">
                            Interactividad Total
                        </h3>
                        <p class="text-gray-700 leading-relaxed">
                            Haga clic en cualquier gráfico o filtro para explorar los datos en profundidad y descubrir insights valiosos.
                        </p>
                    </div>
                    
                    <!-- Card 2 -->
                    <div class="bg-gradient-to-br from-gray-50 to-white p-7 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 border border-gray-100">
                        <div class="gradient-bg w-14 h-14 rounded-xl flex items-center justify-center text-white mb-5 shadow-md">
                            <i class="fas fa-filter text-xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-primary mb-3">
                            Filtros Dinámicos
                        </h3>
                        <p class="text-gray-700 leading-relaxed">
                            Utilice los filtros interactivos para personalizar la vista y analizar diferentes segmentos de datos según sus necesidades.
                        </p>
                    </div>
                    
                    <!-- Card 3 -->
                    <div class="bg-gradient-to-br from-gray-50 to-white p-7 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 border border-gray-100">
                        <div class="gradient-bg w-14 h-14 rounded-xl flex items-center justify-center text-white mb-5 shadow-md">
                            <i class="fas fa-sync-alt text-xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-primary mb-3">
                            Actualización en Tiempo Real
                        </h3>
                        <p class="text-gray-700 leading-relaxed">
                            Los datos se actualizan automáticamente según la programación configurada en Power BI Service, garantizando información actualizada.
                        </p>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="text-center pt-10 border-t border-gray-200">
            
            <p class="text-gray-700 mb-2 font-medium">
                © 2026 Power BI Dashboard | Plataforma de Visualización de Datos
            </p>
            <p class="text-gray-500">
                DGOS-DIMON
            </p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const powerbiFrame = document.getElementById('powerbiFrame');
            const loading = document.getElementById('loading');
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            const toggleStatsBtn = document.getElementById('toggleStats');
            const statsSection = document.getElementById('statsSection');
            const dashboardContainer = document.getElementById('dashboardContainer');
            
            // Estado de pantalla completa
            let isFullscreen = false;
            
            // Ocultar loading cuando el iframe cargue
            powerbiFrame.addEventListener('load', function() {
                setTimeout(() => {
                    loading.classList.add('opacity-0');
                    setTimeout(() => {
                        loading.classList.add('hidden');
                    }, 300);
                }, 800);
            });
            
            // Función para entrar en pantalla completa CORREGIDA
            function enterFullscreen() {
                if (dashboardContainer.requestFullscreen) {
                    dashboardContainer.requestFullscreen();
                } else if (dashboardContainer.mozRequestFullScreen) {
                    dashboardContainer.mozRequestFullScreen();
                } else if (dashboardContainer.webkitRequestFullscreen) {
                    dashboardContainer.webkitRequestFullscreen();
                } else if (dashboardContainer.msRequestFullscreen) {
                    dashboardContainer.msRequestFullscreen();
                }
                
                // Ajustar tamaño del iframe en pantalla completa
                setTimeout(() => {
                    adjustIframeHeight();
                }, 100);
            }
            
            // Función para salir de pantalla completa
            function exitFullscreen() {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
            
            // Botón para pantalla completa - VERSIÓN SIMPLIFICADA Y FUNCIONAL
            fullscreenBtn.addEventListener('click', function() {
                if (!document.fullscreenElement && 
                    !document.webkitFullscreenElement && 
                    !document.mozFullScreenElement && 
                    !document.msFullscreenElement) {
                    
                    // Entrar en pantalla completa
                    enterFullscreen();
                    
                    // Cambiar texto del botón
                    fullscreenBtn.innerHTML = `
                        <i class="fas fa-compress"></i>
                        <span class="font-medium">Salir Pantalla Completa</span>
                    `;
                    
                    isFullscreen = true;
                } else {
                    // Salir de pantalla completa
                    exitFullscreen();
                    
                    // Restaurar texto del botón
                    fullscreenBtn.innerHTML = `
                        <i class="fas fa-expand"></i>
                        <span class="font-medium">Pantalla Completa</span>
                    `;
                    
                    isFullscreen = false;
                }
                
                // Ajustar altura después del cambio
                setTimeout(adjustIframeHeight, 150);
            });
            
            // Detectar cambios en pantalla completa
            document.addEventListener('fullscreenchange', handleFullscreenChange);
            document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
            document.addEventListener('mozfullscreenchange', handleFullscreenChange);
            document.addEventListener('MSFullscreenChange', handleFullscreenChange);
            
            function handleFullscreenChange() {
                const isCurrentlyFullscreen = !!(document.fullscreenElement || 
                                                document.webkitFullscreenElement || 
                                                document.mozFullScreenElement || 
                                                document.msFullscreenElement);
                
                if (isCurrentlyFullscreen) {
                    isFullscreen = true;
                    fullscreenBtn.innerHTML = `
                        <i class="fas fa-compress"></i>
                        <span class="font-medium">Salir Pantalla Completa</span>
                    `;
                } else {
                    isFullscreen = false;
                    fullscreenBtn.innerHTML = `
                        <i class="fas fa-expand"></i>
                        <span class="font-medium">Pantalla Completa</span>
                    `;
                }
                
                adjustIframeHeight();
            }
            
            // Ajustar altura del iframe dinámicamente
            function adjustIframeHeight() {
                if (isFullscreen) {
                    // En pantalla completa: usar 90% de la altura de la ventana
                    const windowHeight = window.innerHeight;
                    const dashboardHeader = document.querySelector('.dashboard-header');
                    const headerHeight = dashboardHeader ? dashboardHeader.offsetHeight : 80;
                    
                    // Calcular altura máxima para el iframe
                    const maxHeight = windowHeight - headerHeight - 40; // 40px de margen
                    
                    if (maxHeight > 400) {
                        powerbiFrame.style.height = `${maxHeight}px`;
                        powerbiFrame.classList.remove('min-h-[600px]');
                    }
                } else {
                    // Modo normal: altura por defecto
                    powerbiFrame.style.height = '75vh';
                    powerbiFrame.classList.add('min-h-[600px]');
                }
            }
            
            // Toggle sección de estadísticas
            toggleStatsBtn.addEventListener('click', function() {
                if (statsSection.classList.contains('hidden')) {
                    statsSection.classList.remove('hidden');
                    toggleStatsBtn.innerHTML = `
                        <i class="fas fa-chart-bar"></i>
                        <span>Ocultar Info</span>
                    `;
                } else {
                    statsSection.classList.add('hidden');
                    toggleStatsBtn.innerHTML = `
                        <i class="fas fa-chart-bar"></i>
                        <span>Mostrar Info</span>
                    `;
                }
            });
            
            // Ajustar altura al redimensionar la ventana
            window.addEventListener('resize', adjustIframeHeight);
            
            // Ajustar altura inicial
            setTimeout(adjustIframeHeight, 100);
            
            // Ocultar info cards en móviles por defecto
            if (window.innerWidth < 768) {
                statsSection.classList.add('hidden');
                toggleStatsBtn.innerHTML = `
                    <i class="fas fa-chart-bar"></i>
                    <span>Mostrar Info</span>
                `;
            }
            
            // También ajustar al cambiar orientación en móviles
            window.addEventListener('orientationchange', function() {
                setTimeout(adjustIframeHeight, 300);
            });
        });
    </script>
</body>
</html>